<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>SocialHub - Sosyal Platform</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
      -webkit-touch-callout: none;
    }

    :root {
      --c-bg: #f5e6d3;
      --c-content: #3d2f1f;
      --c-action: #d4a574;
      --c-glass: #e8d4b8;
      --c-light: #ffffff;
      --c-dark: #2a1f15;
      --c-success: #6b9b6b;
      --c-error: #c97070;
      --c-online: #7cb97c;
      --c-verified: #1da1f2;
    }

    body {
      font-family: "DM Sans", sans-serif;
      background: linear-gradient(135deg, #f5e6d3 0%, #f0dcc4 50%, #f8ead8 100%);
      color: var(--c-content);
      min-height: 100vh;
      min-height: 100dvh;
      overflow-x: hidden;
    }

    body.dark-theme {
      --c-bg: #1a1a2e;
      --c-content: #eaeaea;
      --c-action: #e94560;
      --c-glass: #16213e;
      --c-light: #0f0f1a;
      --c-dark: #ffffff;
      --c-success: #4ecca3;
      --c-error: #e94560;
      --c-online: #4ecca3;
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
    }

    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: 
        radial-gradient(circle at 20% 30%, rgba(212, 165, 116, 0.15) 0%, transparent 50%),
        radial-gradient(circle at 80% 70%, rgba(201, 150, 95, 0.15) 0%, transparent 50%);
      animation: particleFloat 20s ease-in-out infinite;
      pointer-events: none;
      z-index: 0;
    }

    @keyframes particleFloat {
      0%, 100% { transform: translate(0, 0) scale(1); }
      33% { transform: translate(30px, -30px) scale(1.1); }
      66% { transform: translate(-20px, 20px) scale(0.9); }
    }

    /* Login Screen */
    .login-screen {
      position: fixed;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      transition: opacity 500ms ease, visibility 500ms ease;
      background: linear-gradient(135deg, #f5e6d3 0%, #f0dcc4 50%, #f8ead8 100%);
    }

    .login-screen::before {
      content: '';
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at 50% 50%, rgba(212, 165, 116, 0.2) 0%, transparent 70%);
      animation: pulseGlow 4s ease-in-out infinite;
    }

    @keyframes pulseGlow {
      0%, 100% { opacity: 0.5; transform: scale(1); }
      50% { opacity: 1; transform: scale(1.1); }
    }

    .login-screen.hidden {
      opacity: 0;
      visibility: hidden;
      pointer-events: none;
    }

    .glass-form {
      position: relative;
      width: 420px;
      max-width: 92%;
      border-radius: 24px;
      overflow: hidden;
      box-shadow: 
        0 8px 32px rgba(61, 47, 31, 0.2),
        inset 0 0 0 1px rgba(255, 255, 255, 0.5);
      animation: fadeInUp 600ms ease;
      z-index: 10;
    }

    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(30px) scale(0.96); }
      to { opacity: 1; transform: translateY(0) scale(1); }
    }

    .glass-filter {
      position: absolute;
      inset: 0;
      border-radius: inherit;
      backdrop-filter: blur(16px) saturate(1.5);
      -webkit-backdrop-filter: blur(16px) saturate(1.5);
    }

    .glass-overlay {
      position: absolute;
      inset: 0;
      border-radius: inherit;
      background: rgba(232, 212, 184, 0.4);
    }

    .glass-content {
      position: relative;
      z-index: 4;
      padding: 40px;
    }

    .glass-content h3 {
      margin: 0 0 12px;
      font-size: 1.8rem;
      font-weight: 700;
      text-align: center;
    }

    .glass-content .subtitle {
      text-align: center;
      font-size: 0.95rem;
      opacity: 0.8;
      margin-bottom: 28px;
      line-height: 1.5;
    }

    .google-btn {
      width: 100%;
      padding: 14px 20px;
      background: rgba(255, 255, 255, 0.7);
      border: 1px solid rgba(212, 165, 116, 0.4);
      border-radius: 12px;
      color: var(--c-content);
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 250ms ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.8), 0 4px 12px rgba(61, 47, 31, 0.15);
    }

    .google-btn:hover {
      background: rgba(255, 255, 255, 0.9);
      transform: translateY(-2px);
      box-shadow: inset 0 1px 0 rgba(255, 255, 255, 1), 0 6px 20px rgba(61, 47, 31, 0.2);
    }

    .google-btn:active { transform: translateY(0); }

    .google-btn svg { width: 20px; height: 20px; }

    /* Setup Form */
    .setup-form {
      display: none;
    }

    .setup-form.active {
      display: block;
      animation: fadeInUp 400ms ease;
    }

    .form-group {
      position: relative;
      margin-bottom: 16px;
    }

    .form-group label {
      display: block;
      margin-bottom: 6px;
      font-size: 0.9rem;
      font-weight: 600;
      opacity: 0.9;
    }

    .form-group input, .form-group textarea, .form-group select {
      width: 100%;
      padding: 14px 16px;
      background: rgba(255, 255, 255, 0.5);
      border: 1px solid rgba(212, 165, 116, 0.3);
      border-radius: 12px;
      color: var(--c-content);
      font-size: 16px;
      font-family: inherit;
      transition: all 250ms ease;
    }

    .form-group input:focus, .form-group textarea:focus {
      outline: none;
      background: rgba(255, 255, 255, 0.8);
      border-color: var(--c-action);
      box-shadow: 0 0 0 3px rgba(212, 165, 116, 0.2);
    }

    .form-group input::placeholder { color: rgba(61, 47, 31, 0.5); }

    .username-input-wrapper {
      position: relative;
      display: flex;
      align-items: center;
    }

    .username-prefix {
      position: absolute;
      left: 16px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 16px;
      color: var(--c-action);
      font-weight: 600;
      pointer-events: none;
      z-index: 1;
    }

    .form-group input.with-prefix {
      padding-left: 32px;
    }

    .form-hint {
      font-size: 0.8rem;
      opacity: 0.7;
      margin-top: 4px;
    }

    .form-error {
      font-size: 0.8rem;
      color: var(--c-error);
      margin-top: 4px;
      display: none;
    }

    .form-error.show { display: block; }

    .submit-btn {
      width: 100%;
      padding: 14px;
      background: rgba(212, 165, 116, 0.5);
      border: 1px solid rgba(212, 165, 116, 0.7);
      border-radius: 12px;
      color: var(--c-content);
      font-size: 16px;
      font-weight: 600;
      font-family: inherit;
      cursor: pointer;
      transition: all 250ms ease;
      margin-top: 8px;
    }

    .submit-btn:hover {
      background: rgba(212, 165, 116, 0.7);
      transform: translateY(-2px);
    }

    .submit-btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }

    /* Main App */
    .app-container {
      display: none;
      min-height: 100vh;
      min-height: 100dvh;
      padding-bottom: 100px;
    }

    .app-container.active { display: block; }

    /* Header */
    .header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 100;
      padding: 12px 16px;
      display: flex;
      justify-content: center;
    }

    .header-inner {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 10px 20px;
      border-radius: 99px;
      background: rgba(232, 212, 184, 0.4);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      box-shadow: 
        inset 0 0 0 1px rgba(255, 255, 255, 0.3),
        0 4px 16px rgba(42, 31, 21, 0.12);
    }

    .header-logo {
      font-weight: 700;
      font-size: 1.1rem;
      color: var(--c-content);
    }

    .header-user {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 6px 14px 6px 8px;
      background: rgba(255, 255, 255, 0.4);
      border-radius: 99px;
      cursor: pointer;
      transition: background 200ms ease;
    }

    .header-user:hover { background: rgba(255, 255, 255, 0.6); }

    .header-avatar {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      border: 2px solid var(--c-action);
      object-fit: cover;
    }

    .header-name {
      font-weight: 600;
      font-size: 0.9rem;
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .verified-badge {
      color: var(--c-verified);
      font-size: 14px;
    }

    /* Bottom Navigation */
    .bottom-nav {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 100;
    }

    .nav-inner {
      display: flex;
      gap: 4px;
      padding: 8px 12px;
      border-radius: 99px;
      background: rgba(232, 212, 184, 0.4);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      box-shadow: 
        inset 0 0 0 1px rgba(255, 255, 255, 0.3),
        0 4px 16px rgba(42, 31, 21, 0.15);
    }

    .nav-item {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 52px;
      height: 48px;
      border-radius: 99px;
      color: var(--c-content);
      font-size: 20px;
      cursor: pointer;
      transition: all 200ms ease;
      position: relative;
    }

    .nav-item:hover { color: var(--c-action); }

    .nav-item.active {
      background: rgba(232, 212, 184, 0.6);
      box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.4);
    }

    .nav-badge {
      position: absolute;
      top: 6px;
      right: 8px;
      width: 8px;
      height: 8px;
      background: var(--c-error);
      border-radius: 50%;
      display: none;
    }

    .nav-badge.show { display: block; }

    /* Pages */
    .page {
      display: none;
      padding: 90px 16px 20px;
      max-width: 600px;
      margin: 0 auto;
      animation: pageIn 400ms ease;
    }

    .page.active { display: block; }

    @keyframes pageIn {
      from { opacity: 0; transform: translateY(16px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .page-title {
      font-size: 1.6rem;
      font-weight: 700;
      margin-bottom: 20px;
    }

    /* Home Page */
    .welcome-card {
      padding: 28px;
      border-radius: 20px;
      background: rgba(232, 212, 184, 0.5);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      box-shadow: 
        inset 0 0 0 1px rgba(255, 255, 255, 0.4),
        0 8px 24px rgba(42, 31, 21, 0.12);
      margin-bottom: 24px;
    }

    .welcome-greeting {
      font-size: 1.4rem;
      font-weight: 700;
      margin-bottom: 8px;
    }

    .welcome-text {
      opacity: 0.8;
      line-height: 1.5;
    }

    .section-title {
      font-size: 1.1rem;
      font-weight: 700;
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .quick-links {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
      margin-bottom: 28px;
    }

    .quick-link {
      padding: 20px;
      border-radius: 16px;
      background: rgba(255, 255, 255, 0.4);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.5);
      cursor: pointer;
      transition: all 250ms ease;
      text-align: center;
    }

    .quick-link:hover {
      background: rgba(255, 255, 255, 0.6);
      transform: translateY(-2px);
    }

    .quick-link i {
      font-size: 28px;
      color: var(--c-action);
      margin-bottom: 10px;
    }

    .quick-link span {
      display: block;
      font-weight: 600;
      font-size: 0.95rem;
    }

    /* Search */
    .search-box {
      position: relative;
      margin-bottom: 20px;
    }

    .search-box input {
      width: 100%;
      padding: 14px 16px 14px 48px;
      background: rgba(255, 255, 255, 0.5);
      border: 1px solid rgba(212, 165, 116, 0.3);
      border-radius: 14px;
      font-size: 16px;
      font-family: inherit;
      color: var(--c-content);
      transition: all 250ms ease;
    }

    .search-box input:focus {
      outline: none;
      background: rgba(255, 255, 255, 0.8);
      border-color: var(--c-action);
    }

    .search-box i {
      position: absolute;
      left: 16px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--c-content);
      opacity: 0.6;
    }

    /* User Cards */
    .user-list {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .user-card {
      display: flex;
      align-items: center;
      gap: 14px;
      padding: 16px;
      border-radius: 16px;
      background: rgba(255, 255, 255, 0.4);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.5);
      cursor: pointer;
      transition: all 250ms ease;
    }

    .user-card:hover {
      background: rgba(255, 255, 255, 0.6);
      transform: translateX(4px);
    }

    .user-card-avatar {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      border: 2px solid var(--c-action);
      object-fit: cover;
      position: relative;
    }

    .avatar-wrapper {
      position: relative;
    }

    .online-dot {
      position: absolute;
      bottom: 2px;
      right: 2px;
      width: 12px;
      height: 12px;
      background: var(--c-online);
      border: 2px solid var(--c-bg);
      border-radius: 50%;
    }

    .user-card-info {
      flex: 1;
      min-width: 0;
    }

    .user-card-name {
      font-weight: 600;
      margin-bottom: 2px;
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .user-card-username {
      font-size: 0.85rem;
      opacity: 0.7;
    }

    .user-card-action {
      padding: 10px 16px;
      border-radius: 10px;
      background: rgba(212, 165, 116, 0.4);
      border: none;
      color: var(--c-content);
      font-weight: 600;
      font-size: 0.85rem;
      font-family: inherit;
      cursor: pointer;
      transition: all 200ms ease;
      white-space: nowrap;
    }

    .user-card-action:hover {
      background: rgba(212, 165, 116, 0.6);
    }

    .user-card-action.pending {
      background: rgba(107, 155, 107, 0.3);
    }

    .user-card-action.friend {
      background: rgba(107, 155, 107, 0.4);
    }

    /* Friends Page */
    .tabs {
      display: flex;
      gap: 8px;
      margin-bottom: 20px;
      overflow-x: auto;
      padding-bottom: 4px;
    }

    .tab {
      padding: 10px 18px;
      border-radius: 10px;
      background: rgba(255, 255, 255, 0.3);
      border: none;
      font-weight: 600;
      font-size: 0.9rem;
      font-family: inherit;
      color: var(--c-content);
      cursor: pointer;
      transition: all 200ms ease;
      white-space: nowrap;
      position: relative;
    }

    .tab:hover { background: rgba(255, 255, 255, 0.5); }

    .tab.active {
      background: rgba(212, 165, 116, 0.4);
    }

    .tab-badge {
      position: absolute;
      top: -4px;
      right: -4px;
      min-width: 18px;
      height: 18px;
      padding: 0 5px;
      background: var(--c-error);
      border-radius: 99px;
      font-size: 0.7rem;
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .friend-requests {
      margin-bottom: 24px;
    }

    .request-card {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 16px;
      border-radius: 16px;
      background: rgba(255, 255, 255, 0.4);
      backdrop-filter: blur(8px);
      margin-bottom: 10px;
    }

    .request-actions {
      display: flex;
      gap: 8px;
      margin-left: auto;
    }

    .btn-accept, .btn-reject {
      width: 36px;
      height: 36px;
      border-radius: 10px;
      border: none;
      cursor: pointer;
      transition: all 200ms ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .btn-accept {
      background: rgba(107, 155, 107, 0.4);
      color: var(--c-content);
    }

    .btn-accept:hover { background: rgba(107, 155, 107, 0.6); }

    .btn-reject {
      background: rgba(201, 112, 112, 0.3);
      color: var(--c-content);
    }

    .btn-reject:hover { background: rgba(201, 112, 112, 0.5); }

    /* Chat */
    .chat-list {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .chat-item {
      display: flex;
      align-items: center;
      gap: 14px;
      padding: 14px;
      border-radius: 16px;
      background: rgba(255, 255, 255, 0.4);
      cursor: pointer;
      transition: all 200ms ease;
    }

    .chat-item:hover {
      background: rgba(255, 255, 255, 0.6);
    }

    .chat-item-info {
      flex: 1;
      min-width: 0;
    }

    .chat-item-name {
      font-weight: 600;
      margin-bottom: 2px;
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .chat-item-preview {
      font-size: 0.85rem;
      opacity: 0.7;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .chat-item-meta {
      text-align: right;
    }

    .chat-item-time {
      font-size: 0.75rem;
      opacity: 0.6;
      margin-bottom: 4px;
    }

    .chat-unread {
      width: 20px;
      height: 20px;
      background: var(--c-action);
      border-radius: 50%;
      font-size: 0.7rem;
      font-weight: 700;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-left: auto;
    }

    /* Chat View */
    .chat-view {
      display: none;
      position: fixed;
      inset: 0;
      background: linear-gradient(135deg, #f5e6d3 0%, #f0dcc4 50%, #f8ead8 100%);
      z-index: 200;
      flex-direction: column;
    }

    body.dark-theme .chat-view {
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
    }

    .chat-view.active {
      display: flex;
      animation: slideIn 300ms ease;
    }

    @keyframes slideIn {
      from { transform: translateX(100%); }
      to { transform: translateX(0); }
    }

    .chat-header {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 16px;
      background: rgba(232, 212, 184, 0.6);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
    }

    .chat-back {
      width: 40px;
      height: 40px;
      border-radius: 12px;
      background: rgba(255, 255, 255, 0.4);
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      color: var(--c-content);
      transition: background 200ms ease;
    }

    .chat-back:hover { background: rgba(255, 255, 255, 0.6); }

    .chat-header-avatar {
      width: 42px;
      height: 42px;
      border-radius: 50%;
      border: 2px solid var(--c-action);
      object-fit: cover;
    }

    .chat-header-info h4 {
      font-size: 1rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .chat-header-status {
      font-size: 0.8rem;
      opacity: 0.7;
    }

    .chat-messages {
      flex: 1;
      overflow-y: auto;
      padding: 16px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .message {
      max-width: 80%;
      padding: 12px 16px;
      border-radius: 18px;
      font-size: 0.95rem;
      line-height: 1.4;
      position: relative;
    }

    .message.sent {
      align-self: flex-end;
      background: rgba(212, 165, 116, 0.5);
      border-bottom-right-radius: 6px;
    }

    .message.received {
      align-self: flex-start;
      background: rgba(255, 255, 255, 0.6);
      border-bottom-left-radius: 6px;
    }

    .message-time {
      font-size: 0.7rem;
      opacity: 0.6;
      margin-top: 4px;
      text-align: right;
    }

    .chat-input-area {
      display: flex;
      gap: 10px;
      padding: 12px 16px;
      background: rgba(232, 212, 184, 0.6);
      backdrop-filter: blur(12px);
    }

    .chat-input {
      flex: 1;
      padding: 12px 18px;
      border-radius: 99px;
      border: 1px solid rgba(212, 165, 116, 0.3);
      background: rgba(255, 255, 255, 0.6);
      font-size: 16px;
      font-family: inherit;
      color: var(--c-content);
      transition: all 200ms ease;
    }

    .chat-input:focus {
      outline: none;
      border-color: var(--c-action);
      background: rgba(255, 255, 255, 0.8);
    }

    .chat-send {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      background: rgba(212, 165, 116, 0.5);
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      color: var(--c-content);
      transition: all 200ms ease;
    }

    .chat-send:hover {
      background: rgba(212, 165, 116, 0.7);
      transform: scale(1.05);
    }

    /* Profile Page */
    .profile-header {
      text-align: center;
      padding: 24px;
      border-radius: 20px;
      background: rgba(232, 212, 184, 0.5);
      backdrop-filter: blur(12px);
      margin-bottom: 24px;
    }

    .profile-avatar-wrapper {
      position: relative;
      display: inline-block;
    }

    .profile-avatar {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      border: 3px solid var(--c-action);
      object-fit: cover;
      margin-bottom: 16px;
    }

    .profile-verified {
      position: absolute;
      bottom: 12px;
      right: -4px;
      background: white;
      border-radius: 50%;
      padding: 2px;
    }

    .profile-verified i {
      color: var(--c-verified);
      font-size: 24px;
    }

    .profile-name {
      font-size: 1.5rem;
      font-weight: 700;
      margin-bottom: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
    }

    .profile-username {
      font-size: 1rem;
      color: var(--c-action);
      font-weight: 600;
      margin-bottom: 8px;
    }

    .profile-stats {
      display: flex;
      justify-content: center;
      gap: 32px;
      margin-top: 16px;
    }

    .stat {
      text-align: center;
    }

    .stat-value {
      font-size: 1.3rem;
      font-weight: 700;
    }

    .stat-label {
      font-size: 0.8rem;
      opacity: 0.7;
    }

    .social-links {
      display: flex;
      justify-content: center;
      gap: 12px;
      margin-top: 16px;
    }

    .social-link {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--c-content);
      font-size: 18px;
      text-decoration: none;
      transition: all 200ms ease;
    }

    .social-link:hover {
      background: rgba(255, 255, 255, 0.8);
      transform: scale(1.1);
    }

    .social-link.instagram { color: #E4405F; }
    .social-link.tiktok { color: #000000; }
    .social-link.twitter { color: #1DA1F2; }

    .profile-section {
      padding: 20px;
      border-radius: 16px;
      background: rgba(255, 255, 255, 0.4);
      margin-bottom: 16px;
    }

    .profile-section h4 {
      font-size: 1rem;
      font-weight: 600;
      margin-bottom: 12px;
    }

    .profile-info-row {
      display: flex;
      justify-content: space-between;
      padding: 10px 0;
      border-bottom: 1px solid rgba(212, 165, 116, 0.2);
    }

    .profile-info-row:last-child { border-bottom: none; }

    .profile-info-label {
      opacity: 0.7;
    }

    .profile-info-value {
      font-weight: 600;
    }

    .profile-buttons {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-bottom: 16px;
    }

    .profile-btn {
      padding: 14px;
      border-radius: 12px;
      background: rgba(255, 255, 255, 0.4);
      border: none;
      color: var(--c-content);
      font-weight: 600;
      font-size: 0.9rem;
      font-family: inherit;
      cursor: pointer;
      transition: all 200ms ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    .profile-btn:hover {
      background: rgba(255, 255, 255, 0.6);
    }

    .logout-btn {
      width: 100%;
      padding: 14px;
      border-radius: 12px;
      background: rgba(201, 112, 112, 0.3);
      border: none;
      color: var(--c-content);
      font-weight: 600;
      font-size: 1rem;
      font-family: inherit;
      cursor: pointer;
      transition: all 200ms ease;
      margin-top: 20px;
    }

    .logout-btn:hover {
      background: rgba(201, 112, 112, 0.5);
    }

    /* Games Page */
    .games-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
    }

    .game-card {
      padding: 20px;
      border-radius: 16px;
      background: rgba(255, 255, 255, 0.4);
      backdrop-filter: blur(8px);
      text-align: center;
      cursor: pointer;
      transition: all 250ms ease;
    }

    .game-card:hover {
      background: rgba(255, 255, 255, 0.6);
      transform: translateY(-2px);
    }

    .game-card-icon {
      width: 64px;
      height: 64px;
      border-radius: 16px;
      object-fit: cover;
      margin: 0 auto 12px;
      display: block;
    }

    .game-card i {
      font-size: 36px;
      color: var(--c-action);
      margin-bottom: 12px;
    }

    .game-card h4 {
      font-size: 1.1rem;
      font-weight: 700;
      margin-bottom: 4px;
    }

    .game-card p {
      font-size: 0.8rem;
      opacity: 0.7;
    }

    /* Events Page */
    .events-list {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .event-card {
      border-radius: 20px;
      background: rgba(255, 255, 255, 0.4);
      backdrop-filter: blur(8px);
      overflow: hidden;
      cursor: pointer;
      transition: all 250ms ease;
    }

    .event-card:hover {
      background: rgba(255, 255, 255, 0.6);
      transform: translateY(-2px);
    }

    .event-card-image {
      width: 100%;
      height: 160px;
      object-fit: cover;
    }

    .event-card-content {
      padding: 20px;
    }

    .event-card .event-date {
      display: inline-block;
      padding: 6px 12px;
      background: rgba(212, 165, 116, 0.4);
      border-radius: 8px;
      font-size: 0.8rem;
      font-weight: 600;
      margin-bottom: 12px;
    }

    .event-card h4 {
      font-size: 1.2rem;
      font-weight: 700;
      margin-bottom: 8px;
    }

    .event-card p {
      font-size: 0.9rem;
      opacity: 0.8;
      line-height: 1.4;
    }

    .event-card-footer {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-top: 12px;
      padding-top: 12px;
      border-top: 1px solid rgba(212, 165, 116, 0.2);
    }

    .event-participants {
      font-size: 0.85rem;
      opacity: 0.7;
    }

    /* Event Modal */
    .modal-overlay {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.6);
      z-index: 300;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .modal-overlay.active {
      display: flex;
    }

    .modal-content {
      width: 100%;
      max-width: 500px;
      max-height: 90vh;
      overflow-y: auto;
      border-radius: 24px;
      background: var(--c-bg);
      animation: modalIn 300ms ease;
    }

    @keyframes modalIn {
      from { opacity: 0; transform: scale(0.9); }
      to { opacity: 1; transform: scale(1); }
    }

    .modal-header {
      position: relative;
    }

    .modal-header img {
      width: 100%;
      height: 200px;
      object-fit: cover;
    }

    .modal-close {
      position: absolute;
      top: 12px;
      right: 12px;
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: rgba(0, 0, 0, 0.5);
      border: none;
      color: white;
      font-size: 18px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .modal-body {
      padding: 24px;
    }

    .modal-body h2 {
      font-size: 1.5rem;
      font-weight: 700;
      margin-bottom: 8px;
    }

    .modal-event-date {
      display: inline-block;
      padding: 6px 12px;
      background: rgba(212, 165, 116, 0.4);
      border-radius: 8px;
      font-size: 0.85rem;
      font-weight: 600;
      margin-bottom: 16px;
    }

    .modal-event-desc {
      line-height: 1.6;
      opacity: 0.9;
      margin-bottom: 20px;
    }

    .modal-section-title {
      font-size: 1rem;
      font-weight: 700;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .join-btn {
      width: 100%;
      padding: 16px;
      border-radius: 14px;
      background: rgba(212, 165, 116, 0.5);
      border: none;
      color: var(--c-content);
      font-size: 1rem;
      font-weight: 700;
      font-family: inherit;
      cursor: pointer;
      transition: all 200ms ease;
      margin-bottom: 20px;
    }

    .join-btn:hover {
      background: rgba(212, 165, 116, 0.7);
    }

    .join-btn.joined {
      background: rgba(107, 155, 107, 0.4);
    }

    /* Q&A Section */
    .qa-section {
      margin-top: 24px;
      padding-top: 20px;
      border-top: 1px solid rgba(212, 165, 116, 0.2);
    }

    .qa-list {
      display: flex;
      flex-direction: column;
      gap: 16px;
      margin-bottom: 16px;
    }

    .qa-item {
      padding: 16px;
      border-radius: 14px;
      background: rgba(255, 255, 255, 0.3);
    }

    .qa-question {
      font-weight: 600;
      margin-bottom: 8px;
      display: flex;
      align-items: flex-start;
      gap: 8px;
    }

    .qa-question i {
      color: var(--c-action);
      margin-top: 2px;
    }

    .qa-answer {
      padding-left: 24px;
      opacity: 0.85;
      line-height: 1.5;
    }

    .qa-answerer {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 0.85rem;
      font-weight: 600;
      color: var(--c-action);
      margin-bottom: 4px;
    }

    .qa-form {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .qa-form textarea {
      width: 100%;
      padding: 12px 16px;
      border-radius: 12px;
      border: 1px solid rgba(212, 165, 116, 0.3);
      background: rgba(255, 255, 255, 0.5);
      font-size: 14px;
      font-family: inherit;
      color: var(--c-content);
      resize: none;
      min-height: 80px;
    }

    .qa-form textarea:focus {
      outline: none;
      border-color: var(--c-action);
    }

    .qa-submit {
      padding: 12px 20px;
      border-radius: 10px;
      background: rgba(212, 165, 116, 0.4);
      border: none;
      color: var(--c-content);
      font-weight: 600;
      font-family: inherit;
      cursor: pointer;
      align-self: flex-end;
    }

    .qa-submit:hover {
      background: rgba(212, 165, 116, 0.6);
    }

    /* Settings Modal */
    .settings-modal {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.6);
      z-index: 300;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .settings-modal.active {
      display: flex;
    }

    .settings-content {
      width: 100%;
      max-width: 400px;
      border-radius: 24px;
      background: var(--c-bg);
      padding: 24px;
    }

    .settings-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 24px;
    }

    .settings-header h3 {
      font-size: 1.3rem;
      font-weight: 700;
    }

    .settings-close {
      width: 36px;
      height: 36px;
      border-radius: 10px;
      background: rgba(212, 165, 116, 0.2);
      border: none;
      color: var(--c-content);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .settings-group {
      margin-bottom: 20px;
    }

    .settings-group label {
      display: block;
      font-weight: 600;
      margin-bottom: 10px;
    }

    .toggle-switch {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 14px 16px;
      border-radius: 12px;
      background: rgba(255, 255, 255, 0.3);
      cursor: pointer;
    }

    .toggle-switch input {
      display: none;
    }

    .toggle-track {
      width: 48px;
      height: 28px;
      border-radius: 99px;
      background: rgba(212, 165, 116, 0.3);
      position: relative;
      transition: background 200ms ease;
    }

    .toggle-track::after {
      content: '';
      position: absolute;
      top: 4px;
      left: 4px;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: white;
      transition: transform 200ms ease;
    }

    .toggle-switch input:checked + .toggle-track {
      background: var(--c-action);
    }

    .toggle-switch input:checked + .toggle-track::after {
      transform: translateX(20px);
    }

    .social-input-group {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .social-input-row {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .social-input-row i {
      width: 24px;
      font-size: 18px;
      text-align: center;
    }

    .social-input-row input {
      flex: 1;
      padding: 12px 14px;
      border-radius: 10px;
      border: 1px solid rgba(212, 165, 116, 0.3);
      background: rgba(255, 255, 255, 0.5);
      font-size: 14px;
      font-family: inherit;
      color: var(--c-content);
    }

    .social-input-row input:focus {
      outline: none;
      border-color: var(--c-action);
    }

    .settings-save {
      width: 100%;
      padding: 14px;
      border-radius: 12px;
      background: rgba(212, 165, 116, 0.5);
      border: none;
      color: var(--c-content);
      font-weight: 600;
      font-size: 1rem;
      font-family: inherit;
      cursor: pointer;
      margin-top: 10px;
    }

    .settings-save:hover {
      background: rgba(212, 165, 116, 0.7);
    }

    /* User Profile Modal */
    .user-profile-modal {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.6);
      z-index: 300;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .user-profile-modal.active {
      display: flex;
    }

    .user-profile-content {
      width: 100%;
      max-width: 400px;
      border-radius: 24px;
      background: var(--c-bg);
      padding: 24px;
      text-align: center;
    }

    .user-profile-close {
      position: absolute;
      top: 12px;
      right: 12px;
      width: 36px;
      height: 36px;
      border-radius: 10px;
      background: rgba(212, 165, 116, 0.2);
      border: none;
      color: var(--c-content);
      cursor: pointer;
    }

    /* My Events Page */
    .my-events-list {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .my-event-item {
      display: flex;
      align-items: center;
      gap: 14px;
      padding: 16px;
      border-radius: 16px;
      background: rgba(255, 255, 255, 0.4);
      cursor: pointer;
    }

    .my-event-item img {
      width: 60px;
      height: 60px;
      border-radius: 12px;
      object-fit: cover;
    }

    .my-event-info {
      flex: 1;
    }

    .my-event-info h4 {
      font-weight: 600;
      margin-bottom: 4px;
    }

    .my-event-info p {
      font-size: 0.85rem;
      opacity: 0.7;
    }

    /* Empty State */
    .empty-state {
      text-align: center;
      padding: 40px 20px;
      opacity: 0.7;
    }

    .empty-state i {
      font-size: 48px;
      margin-bottom: 16px;
      opacity: 0.5;
    }

    .empty-state p {
      font-size: 0.95rem;
    }

    /* Loading */
    .loading {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 40px;
    }

    .spinner {
      width: 32px;
      height: 32px;
      border: 3px solid rgba(212, 165, 116, 0.3);
      border-top-color: var(--c-action);
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Toast */
    .toast {
      position: fixed;
      bottom: 100px;
      left: 50%;
      transform: translateX(-50%) translateY(100px);
      padding: 12px 24px;
      border-radius: 12px;
      background: rgba(61, 47, 31, 0.9);
      color: white;
      font-weight: 500;
      z-index: 1000;
      opacity: 0;
      transition: all 300ms ease;
      pointer-events: none;
    }

    .toast.show {
      opacity: 1;
      transform: translateX(-50%) translateY(0);
    }

    /* Notification Popup */
    .notification-popup {
      position: fixed;
      top: 80px;
      right: 20px;
      max-width: 320px;
      padding: 16px 20px;
      border-radius: 16px;
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(12px);
      box-shadow: 0 8px 32px rgba(61, 47, 31, 0.2);
      z-index: 1001;
      transform: translateX(400px);
      transition: transform 300ms ease;
      cursor: pointer;
    }

    .notification-popup.show {
      transform: translateX(0);
    }

    .notification-popup .notification-content {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .notification-popup .notification-avatar {
      width: 44px;
      height: 44px;
      border-radius: 50%;
      border: 2px solid var(--c-action);
      object-fit: cover;
    }

    .notification-popup .notification-text {
      flex: 1;
    }

    .notification-popup .notification-title {
      font-weight: 600;
      font-size: 0.95rem;
      margin-bottom: 2px;
      color: var(--c-content);
    }

    .notification-popup .notification-desc {
      font-size: 0.85rem;
      opacity: 0.7;
      color: var(--c-content);
    }

    /* Responsive */
    @media (max-width: 480px) {
      .glass-content { padding: 28px 20px; }
      .page { padding: 80px 12px 20px; }
      .quick-links { grid-template-columns: 1fr 1fr; gap: 10px; }
      .quick-link { padding: 16px; }
      .quick-link i { font-size: 24px; }
      .message { max-width: 85%; }
      .notification-popup { right: 10px; left: 10px; max-width: none; }
      .profile-buttons { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <!-- Login Screen -->
  <div class="login-screen" id="loginScreen">
    <div class="glass-form">
      <div class="glass-filter"></div>
      <div class="glass-overlay"></div>
      <div class="glass-content">
        <!-- Google Login -->
        <div id="googleLogin">
          <h3>Hos Geldin</h3>
          <p class="subtitle">Sosyal platformumuza katil ve yeni insanlarla tanisarak baglanti kur</p>
          <button class="google-btn" onclick="signInWithGoogle()">
            <svg viewBox="0 0 24 24">
              <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
              <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
              <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
              <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
            </svg>
            Google ile Giris Yap
          </button>
        </div>

        <!-- Setup Form -->
        <div class="setup-form" id="setupForm">
          <h3>Profilini Olustur</h3>
          <p class="subtitle">Hesabini tamamlamak icin bilgilerini gir</p>
          
          <div class="form-group">
            <label>Isim Soyisim</label>
            <input type="text" id="displayName" placeholder="Adin Soyadin">
          </div>
          
          <div class="form-group">
            <label>Kullanici Adi</label>
            <div class="username-input-wrapper">
              <span class="username-prefix">@</span>
              <input type="text" id="username" class="with-prefix" placeholder="kullaniciadi" maxlength="20">
            </div>
            <p class="form-hint">Sadece harf, rakam ve alt cizgi kullanilabilir</p>
            <p class="form-error" id="usernameError"></p>
          </div>
          
          <div class="form-group">
            <label>Dogum Tarihi</label>
            <input type="date" id="birthDate">
          </div>
          
          <button class="submit-btn" id="completeSetup" onclick="completeProfile()">Profili Tamamla</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Main App -->
  <div class="app-container" id="appContainer">
    <!-- Header -->
    <header class="header">
      <div class="header-inner">
        <span class="header-logo">SocialHub</span>
        <div class="header-user" onclick="navigateTo('profile')">
          <img class="header-avatar" id="headerAvatar" src="https://ui-avatars.com/api/?name=U&background=d4a574&color=3d2f1f" alt="Avatar">
          <span class="header-name" id="headerName">Kullanici</span>
        </div>
      </div>
    </header>

    <!-- Pages -->
    <main>
      <!-- Home Page -->
      <div class="page active" id="homePage">
        <div class="welcome-card">
          <p class="welcome-greeting" id="welcomeGreeting">Merhaba!</p>
          <p class="welcome-text">Bugun yeni insanlarla tanisabilir, arkadaslarinla sohbet edebilirsin.</p>
        </div>

        <h3 class="section-title"><i class="fas fa-compass"></i> Hizli Erisim</h3>
        <div class="quick-links">
          <div class="quick-link" onclick="navigateTo('search')">
            <i class="fas fa-search"></i>
            <span>Kullanici Ara</span>
          </div>
          <div class="quick-link" onclick="navigateTo('friends')">
            <i class="fas fa-user-friends"></i>
            <span>Arkadaslar</span>
          </div>
          <div class="quick-link" onclick="navigateTo('chat')">
            <i class="fas fa-comments"></i>
            <span>Mesajlar</span>
          </div>
          <div class="quick-link" onclick="navigateTo('profile')">
            <i class="fas fa-user"></i>
            <span>Profil</span>
          </div>
        </div>

        <h3 class="section-title"><i class="fas fa-rocket"></i> Kesfet</h3>
        <div class="quick-links">
          <div class="quick-link" onclick="navigateTo('games')">
            <i class="fas fa-gamepad"></i>
            <span>Oyunlar</span>
          </div>
          <div class="quick-link" onclick="navigateTo('events')">
            <i class="fas fa-calendar-alt"></i>
            <span>Etkinlikler</span>
          </div>
        </div>
      </div>

      <!-- Search Page -->
      <div class="page" id="searchPage">
        <h2 class="page-title">Kullanici Ara</h2>
        <div class="search-box">
          <i class="fas fa-search"></i>
          <input type="text" id="searchInput" placeholder="Isim veya kullanici adi ara..." oninput="searchUsers()">
        </div>
        <div class="user-list" id="searchResults">
          <div class="empty-state">
            <i class="fas fa-users"></i>
            <p>Yeni insanlarla tanismak icin aramaya basla</p>
          </div>
        </div>
      </div>

      <!-- Friends Page -->
      <div class="page" id="friendsPage">
        <h2 class="page-title">Arkadaslar</h2>
        <div class="tabs">
          <button class="tab active" onclick="switchFriendsTab('friends')">Arkadaslar</button>
          <button class="tab" onclick="switchFriendsTab('requests')">Istekler <span class="tab-badge" id="requestsBadge" style="display:none;">0</span></button>
          <button class="tab" onclick="switchFriendsTab('sent')">Gonderilenler</button>
        </div>
        <div id="friendsContent">
          <div class="user-list" id="friendsList"></div>
        </div>
      </div>

      <!-- Chat Page -->
      <div class="page" id="chatPage">
        <h2 class="page-title">Mesajlar</h2>
        <div class="chat-list" id="chatList">
          <div class="empty-state">
            <i class="fas fa-comment-dots"></i>
            <p>Henuz bir sohbetin yok. Arkadaslarinla mesajlasmaya basla!</p>
          </div>
        </div>
      </div>

      <!-- Games Page -->
      <div class="page" id="gamesPage">
        <h2 class="page-title">Oyunlar</h2>
        <div class="games-grid" id="gamesGrid">
          <div class="empty-state">
            <i class="fas fa-gamepad"></i>
            <p>Henuz oyun eklenmemis</p>
          </div>
        </div>
      </div>

      <!-- Events Page -->
      <div class="page" id="eventsPage">
        <h2 class="page-title">Etkinlikler</h2>
        <div class="events-list" id="eventsList">
          <div class="empty-state">
            <i class="fas fa-calendar-alt"></i>
            <p>Henuz etkinlik eklenmemis</p>
          </div>
        </div>
      </div>

      <!-- My Events Page -->
      <div class="page" id="myEventsPage">
        <h2 class="page-title">Katildigim Etkinlikler</h2>
        <div class="my-events-list" id="myEventsList">
          <div class="empty-state">
            <i class="fas fa-calendar-check"></i>
            <p>Henuz bir etkinlige katilmadiniz</p>
          </div>
        </div>
      </div>

      <!-- Profile Page -->
      <div class="page" id="profilePage">
        <div class="profile-header">
          <div class="profile-avatar-wrapper">
            <img class="profile-avatar" id="profileAvatar" src="https://ui-avatars.com/api/?name=U&background=d4a574&color=3d2f1f&size=200" alt="Avatar">
            <div class="profile-verified" id="profileVerified" style="display:none;">
              <i class="fas fa-check-circle"></i>
            </div>
          </div>
          <h2 class="profile-name" id="profileName">Kullanici</h2>
          <p class="profile-username" id="profileUsername">@kullanici</p>
          <div class="profile-stats">
            <div class="stat">
              <div class="stat-value" id="friendCount">0</div>
              <div class="stat-label">Arkadas</div>
            </div>
          </div>
          <div class="social-links" id="socialLinks" style="display:none;"></div>
        </div>

        <div class="profile-buttons">
          <button class="profile-btn" onclick="navigateTo('myEvents')">
            <i class="fas fa-calendar-check"></i> Etkinliklerim
          </button>
          <button class="profile-btn" onclick="openSettings()">
            <i class="fas fa-cog"></i> Ayarlar
          </button>
        </div>
        
        <div class="profile-section">
          <h4>Bilgiler</h4>
          <div class="profile-info-row">
            <span class="profile-info-label">E-posta</span>
            <span class="profile-info-value" id="profileEmail">-</span>
          </div>
          <div class="profile-info-row">
            <span class="profile-info-label">Dogum Tarihi</span>
            <span class="profile-info-value" id="profileBirthDate">-</span>
          </div>
          <div class="profile-info-row">
            <span class="profile-info-label">Katilim Tarihi</span>
            <span class="profile-info-value" id="profileJoinDate">-</span>
          </div>
        </div>

        <button class="logout-btn" onclick="signOut()">
          <i class="fas fa-sign-out-alt"></i> Cikis Yap
        </button>
      </div>
    </main>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
      <div class="nav-inner">
        <div class="nav-item active" onclick="navigateTo('home')" data-page="home">
          <i class="fas fa-home"></i>
        </div>
        <div class="nav-item" onclick="navigateTo('search')" data-page="search">
          <i class="fas fa-search"></i>
        </div>
        <div class="nav-item" onclick="navigateTo('friends')" data-page="friends">
          <i class="fas fa-user-friends"></i>
          <span class="nav-badge" id="friendsNavBadge"></span>
        </div>
        <div class="nav-item" onclick="navigateTo('chat')" data-page="chat">
          <i class="fas fa-comments"></i>
          <span class="nav-badge" id="chatNavBadge"></span>
        </div>
        <div class="nav-item" onclick="navigateTo('profile')" data-page="profile">
          <i class="fas fa-user"></i>
        </div>
      </div>
    </nav>
  </div>

  <!-- Chat View -->
  <div class="chat-view" id="chatView">
    <div class="chat-header">
      <button class="chat-back" onclick="closeChatView()">
        <i class="fas fa-arrow-left"></i>
      </button>
      <img class="chat-header-avatar" id="chatViewAvatar" src="https://ui-avatars.com/api/?name=U&background=d4a574&color=3d2f1f" alt="Avatar">
      <div class="chat-header-info">
        <h4 id="chatViewName">Kullanici</h4>
        <p class="chat-header-status" id="chatViewStatus">Cevrimdisi</p>
      </div>
    </div>
    <div class="chat-messages" id="chatMessages"></div>
    <div class="chat-input-area">
      <input type="text" class="chat-input" id="messageInput" placeholder="Mesaj yaz..." onkeypress="handleMessageKeypress(event)">
      <button class="chat-send" onclick="sendMessage()">
        <i class="fas fa-paper-plane"></i>
      </button>
    </div>
  </div>

  <!-- Event Modal -->
  <div class="modal-overlay" id="eventModal">
    <div class="modal-content">
      <div class="modal-header">
        <img id="eventModalImage" src="https://via.placeholder.com/500x200" alt="">
        <button class="modal-close" onclick="closeEventModal()">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="modal-body">
        <h2 id="eventModalTitle">Etkinlik Adi</h2>
        <span class="modal-event-date" id="eventModalDate">Tarih</span>
        <p class="modal-event-desc" id="eventModalDesc">Aciklama</p>
        
        <button class="join-btn" id="eventJoinBtn" onclick="toggleEventJoin()">
          <i class="fas fa-hand-paper"></i> Katilmak Istiyorum
        </button>

        <p class="event-participants" id="eventModalParticipants">0 kisi katiliyor</p>

        <div class="qa-section">
          <h4 class="modal-section-title"><i class="fas fa-question-circle"></i> Soru & Cevap</h4>
          <div class="qa-list" id="eventQAList"></div>
          <div class="qa-form">
            <textarea id="questionInput" placeholder="Sorunuzu yazin..."></textarea>
            <button class="qa-submit" onclick="submitQuestion()">Soru Sor</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Settings Modal -->
  <div class="settings-modal" id="settingsModal">
    <div class="settings-content">
      <div class="settings-header">
        <h3>Ayarlar</h3>
        <button class="settings-close" onclick="closeSettings()">
          <i class="fas fa-times"></i>
        </button>
      </div>

      <div class="settings-group">
        <label>Tema</label>
        <div class="toggle-switch" onclick="toggleTheme()">
          <span>Karanlik Tema</span>
          <input type="checkbox" id="darkThemeToggle">
          <div class="toggle-track"></div>
        </div>
      </div>

      <div class="settings-group">
        <label>Sosyal Medya Hesaplari</label>
        <div class="social-input-group">
          <div class="social-input-row">
            <i class="fab fa-instagram" style="color:#E4405F"></i>
            <input type="text" id="instagramUsername" placeholder="Instagram kullanici adi">
          </div>
          <div class="social-input-row">
            <i class="fab fa-tiktok" style="color:#000"></i>
            <input type="text" id="tiktokUsername" placeholder="TikTok kullanici adi">
          </div>
          <div class="social-input-row">
            <i class="fab fa-x-twitter" style="color:#1DA1F2"></i>
            <input type="text" id="twitterUsername" placeholder="X kullanici adi">
          </div>
        </div>
      </div>

      <button class="settings-save" onclick="saveSettings()">Kaydet</button>
    </div>
  </div>

  <!-- User Profile Modal -->
  <div class="user-profile-modal" id="userProfileModal">
    <div class="user-profile-content">
      <button class="settings-close" onclick="closeUserProfile()" style="position:absolute;top:12px;right:12px;">
        <i class="fas fa-times"></i>
      </button>
      <div class="profile-avatar-wrapper">
        <img class="profile-avatar" id="userProfileAvatar" src="" alt="">
        <div class="profile-verified" id="userProfileVerified" style="display:none;">
          <i class="fas fa-check-circle"></i>
        </div>
      </div>
      <h2 class="profile-name" id="userProfileName">Kullanici</h2>
      <p class="profile-username" id="userProfileUsername">@kullanici</p>
      <div class="profile-stats" style="margin-bottom:16px;">
        <div class="stat">
          <div class="stat-value" id="userProfileFriendCount">0</div>
          <div class="stat-label">Arkadas</div>
        </div>
      </div>
      <div class="social-links" id="userProfileSocialLinks" style="margin-bottom:16px;"></div>
      <button class="user-card-action" id="userProfileActionBtn" style="width:100%;padding:14px;">Arkadas Ekle</button>
    </div>
  </div>

  <!-- Notification Popup -->
  <div class="notification-popup" id="notificationPopup" onclick="handleNotificationClick()">
    <div class="notification-content">
      <img class="notification-avatar" id="notificationAvatar" src="" alt="">
      <div class="notification-text">
        <div class="notification-title" id="notificationTitle"></div>
        <div class="notification-desc" id="notificationDesc"></div>
      </div>
    </div>
  </div>

  <!-- Toast -->
  <div class="toast" id="toast"></div>

  <!-- Firebase SDK -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
    import { 
      getAuth, 
      signInWithPopup, 
      GoogleAuthProvider, 
      onAuthStateChanged,
      signOut as firebaseSignOut 
    } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-auth.js";
    import { 
      getDatabase, 
      ref, 
      set, 
      get, 
      push, 
      onValue, 
      off,
      query, 
      orderByChild, 
      equalTo,
      update,
      serverTimestamp,
      limitToLast,
      onChildAdded,
      remove
    } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-database.js";

    // Firebase Config
    const firebaseConfig = {
      apiKey: "AIzaSyCbBh9ulc4_tds31MsDbiSgaHPUU3l0Qx4",
      authDomain: "maps-52b00.firebaseapp.com",
      databaseURL: "https://maps-52b00-default-rtdb.europe-west1.firebasedatabase.app",
      projectId: "maps-52b00",
      storageBucket: "maps-52b00.firebasestorage.app",
      messagingSenderId: "485125559932",
      appId: "1:485125559932:web:7d304f3f2cda4ef4c21bf9"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getDatabase(app);
    const provider = new GoogleAuthProvider();

    let currentUser = null;
    let currentUserData = null;
    let currentChatUserId = null;
    let chatListener = null;
    let friendsListener = null;
    let requestsListener = null;
    let friendsCountListener = null;
    let lastNotificationData = null;
    let currentEventId = null;

    // Auth State
    onAuthStateChanged(auth, async (user) => {
      if (user) {
        currentUser = user;
        const userRef = ref(db, `users/${user.uid}`);
        const snapshot = await get(userRef);
        
        if (snapshot.exists() && snapshot.val().username) {
          currentUserData = snapshot.val();
          
          // Check if banned
          if (currentUserData.banned) {
            showToast("Hesabiniz engellenmi. Giris yapamazsiniz.");
            await firebaseSignOut(auth);
            return;
          }
          
          showApp();
          updateUserOnlineStatus(true);
          loadFriendRequests();
          loadChats();
          loadFriendCountRealtime();
          loadGames();
          loadEvents();
          loadTheme();
        } else {
          showSetupForm(user);
        }
      } else {
        currentUser = null;
        currentUserData = null;
        showLogin();
      }
    });

    // Sign In with Google
    window.signInWithGoogle = async () => {
      try {
        await signInWithPopup(auth, provider);
      } catch (error) {
        console.error("Login error:", error);
        showToast("Giris yapilamadi. Tekrar deneyin.");
      }
    };

    // Sign Out
    window.signOut = async () => {
      try {
        await updateUserOnlineStatus(false);
        await firebaseSignOut(auth);
      } catch (error) {
        console.error("Logout error:", error);
      }
    };

    // Show Login
    function showLogin() {
      document.getElementById('loginScreen').classList.remove('hidden');
      document.getElementById('appContainer').classList.remove('active');
    }

    // Show Setup Form
    function showSetupForm(user) {
      document.getElementById('googleLogin').style.display = 'none';
      document.getElementById('setupForm').classList.add('active');
      document.getElementById('displayName').value = user.displayName || '';
    }

    // Show App
    function showApp() {
      document.getElementById('loginScreen').classList.add('hidden');
      document.getElementById('appContainer').classList.add('active');
      updateUIWithUserData();
    }

    // Update UI
    function updateUIWithUserData() {
      if (!currentUserData) return;
      
      const verifiedBadge = currentUserData.verified ? '<i class="fas fa-check-circle verified-badge"></i>' : '';
      
      document.getElementById('headerAvatar').src = currentUserData.photoURL;
      document.getElementById('headerName').innerHTML = currentUserData.displayName.split(' ')[0] + ' ' + verifiedBadge;
      document.getElementById('welcomeGreeting').textContent = `Merhaba, ${currentUserData.displayName.split(' ')[0]}!`;
      
      document.getElementById('profileAvatar').src = currentUserData.photoURL;
      document.getElementById('profileName').textContent = currentUserData.displayName;
      document.getElementById('profileUsername').textContent = '@' + currentUserData.username;
      document.getElementById('profileEmail').textContent = currentUserData.email;
      document.getElementById('profileBirthDate').textContent = currentUserData.birthDate || '-';
      document.getElementById('profileJoinDate').textContent = formatDate(currentUserData.createdAt);
      
      // Verified badge
      if (currentUserData.verified) {
        document.getElementById('profileVerified').style.display = 'block';
      } else {
        document.getElementById('profileVerified').style.display = 'none';
      }
      
      // Social links
      updateSocialLinks();
    }

    // Update Social Links
    function updateSocialLinks() {
      const container = document.getElementById('socialLinks');
      let html = '';
      let hasLinks = false;
      
      if (currentUserData.instagram) {
        html += `<a href="https://www.instagram.com/${currentUserData.instagram}" target="_blank" class="social-link instagram"><i class="fab fa-instagram"></i></a>`;
        hasLinks = true;
      }
      if (currentUserData.tiktok) {
        html += `<a href="https://www.tiktok.com/@${currentUserData.tiktok}" target="_blank" class="social-link tiktok"><i class="fab fa-tiktok"></i></a>`;
        hasLinks = true;
      }
      if (currentUserData.twitter) {
        html += `<a href="https://www.x.com/${currentUserData.twitter}" target="_blank" class="social-link twitter"><i class="fab fa-x-twitter"></i></a>`;
        hasLinks = true;
      }
      
      container.innerHTML = html;
      container.style.display = hasLinks ? 'flex' : 'none';
    }

    // Complete Profile
    window.completeProfile = async () => {
      const displayName = document.getElementById('displayName').value.trim();
      const username = document.getElementById('username').value.trim().toLowerCase();
      const birthDate = document.getElementById('birthDate').value;
      
      if (!displayName || !username || !birthDate) {
        showToast("Lutfen tum alanlari doldurun");
        return;
      }
      
      if (!/^[a-z0-9_]+$/.test(username)) {
        document.getElementById('usernameError').textContent = "Sadece kucuk harf, rakam ve alt cizgi kullanilabilir";
        document.getElementById('usernameError').classList.add('show');
        return;
      }
      
      // Check username availability
      const usernameQuery = query(ref(db, 'users'), orderByChild('username'), equalTo(username));
      const usernameSnapshot = await get(usernameQuery);
      
      if (usernameSnapshot.exists()) {
        document.getElementById('usernameError').textContent = "Bu kullanici adi zaten alinmi";
        document.getElementById('usernameError').classList.add('show');
        return;
      }
      
      try {
        const userData = {
          uid: currentUser.uid,
          email: currentUser.email,
          displayName,
          username,
          birthDate,
          photoURL: currentUser.photoURL || `https://ui-avatars.com/api/?name=${encodeURIComponent(displayName)}&background=d4a574&color=3d2f1f`,
          createdAt: Date.now(),
          online: true,
          lastSeen: Date.now(),
          verified: false
        };
        
        await set(ref(db, `users/${currentUser.uid}`), userData);
        currentUserData = userData;
        showApp();
        loadFriendRequests();
        loadChats();
        loadFriendCountRealtime();
        loadGames();
        loadEvents();
      } catch (error) {
        console.error("Profile error:", error);
        showToast("Bir hata olustu. Tekrar deneyin.");
      }
    };

    // Update Online Status
    async function updateUserOnlineStatus(isOnline) {
      if (!currentUser) return;
      try {
        await update(ref(db, `users/${currentUser.uid}`), {
          online: isOnline,
          lastSeen: Date.now()
        });
      } catch (error) {
        console.error("Status error:", error);
      }
    }

    // Navigation
    window.navigateTo = (page) => {
      document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
      document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
      
      document.getElementById(page + 'Page').classList.add('active');
      const navItem = document.querySelector(`.nav-item[data-page="${page}"]`);
      if (navItem) navItem.classList.add('active');
      
      if (page === 'friends') {
        loadFriends();
      } else if (page === 'myEvents') {
        loadMyEvents();
      }
    };

    // Search Users
    window.searchUsers = async () => {
      const searchTerm = document.getElementById('searchInput').value.trim().toLowerCase();
      const container = document.getElementById('searchResults');
      
      if (!searchTerm) {
        container.innerHTML = '<div class="empty-state"><i class="fas fa-users"></i><p>Yeni insanlarla tanismak icin aramaya basla</p></div>';
        return;
      }
      
      const snapshot = await get(ref(db, 'users'));
      if (!snapshot.exists()) {
        container.innerHTML = '<div class="empty-state"><i class="fas fa-user-slash"></i><p>Kullanici bulunamadi</p></div>';
        return;
      }
      
      let html = '';
      snapshot.forEach((child) => {
        const user = child.val();
        if (user.uid === currentUser.uid) return;
        
        if (user.displayName.toLowerCase().includes(searchTerm) || 
            user.username.toLowerCase().includes(searchTerm)) {
          const verifiedBadge = user.verified ? '<i class="fas fa-check-circle verified-badge"></i>' : '';
          html += `
            <div class="user-card" onclick="openUserProfile('${user.uid}')">
              <div class="avatar-wrapper">
                <img class="user-card-avatar" src="${user.photoURL}" alt="">
                ${user.online ? '<div class="online-dot"></div>' : ''}
              </div>
              <div class="user-card-info">
                <div class="user-card-name">${user.displayName} ${verifiedBadge}</div>
                <div class="user-card-username">@${user.username}</div>
              </div>
            </div>
          `;
        }
      });
      
      container.innerHTML = html || '<div class="empty-state"><i class="fas fa-user-slash"></i><p>Kullanici bulunamadi</p></div>';
    };

    // Open User Profile
    window.openUserProfile = async (userId) => {
      const snapshot = await get(ref(db, `users/${userId}`));
      if (!snapshot.exists()) return;
      
      const user = snapshot.val();
      
      document.getElementById('userProfileAvatar').src = user.photoURL;
      document.getElementById('userProfileName').textContent = user.displayName;
      document.getElementById('userProfileUsername').textContent = '@' + user.username;
      
      // Verified badge
      if (user.verified) {
        document.getElementById('userProfileVerified').style.display = 'block';
      } else {
        document.getElementById('userProfileVerified').style.display = 'none';
      }
      
      // Friend count
      const friendsSnapshot = await get(ref(db, `friends/${userId}`));
      const friendCount = friendsSnapshot.exists() ? Object.keys(friendsSnapshot.val()).length : 0;
      document.getElementById('userProfileFriendCount').textContent = friendCount;
      
      // Social links
      const socialContainer = document.getElementById('userProfileSocialLinks');
      let socialHtml = '';
      if (user.instagram) {
        socialHtml += `<a href="https://www.instagram.com/${user.instagram}" target="_blank" class="social-link instagram"><i class="fab fa-instagram"></i></a>`;
      }
      if (user.tiktok) {
        socialHtml += `<a href="https://www.tiktok.com/@${user.tiktok}" target="_blank" class="social-link tiktok"><i class="fab fa-tiktok"></i></a>`;
      }
      if (user.twitter) {
        socialHtml += `<a href="https://www.x.com/${user.twitter}" target="_blank" class="social-link twitter"><i class="fab fa-x-twitter"></i></a>`;
      }
      socialContainer.innerHTML = socialHtml;
      socialContainer.style.display = socialHtml ? 'flex' : 'none';
      
      // Action button
      const actionBtn = document.getElementById('userProfileActionBtn');
      const isFriend = await checkFriendship(userId);
      const isPending = await checkPendingRequest(userId);
      
      if (isFriend) {
        actionBtn.textContent = 'Mesaj Gonder';
        actionBtn.className = 'user-card-action friend';
        actionBtn.onclick = () => { closeUserProfile(); openChat(userId); };
      } else if (isPending) {
        actionBtn.textContent = 'Istek Gonderildi';
        actionBtn.className = 'user-card-action pending';
        actionBtn.onclick = null;
      } else {
        actionBtn.textContent = 'Arkadas Ekle';
        actionBtn.className = 'user-card-action';
        actionBtn.onclick = () => { sendFriendRequest(userId); };
      }
      
      document.getElementById('userProfileModal').classList.add('active');
    };

    window.closeUserProfile = () => {
      document.getElementById('userProfileModal').classList.remove('active');
    };

    // Check friendship
    async function checkFriendship(userId) {
      const snapshot = await get(ref(db, `friends/${currentUser.uid}/${userId}`));
      return snapshot.exists();
    }

    // Check pending request
    async function checkPendingRequest(userId) {
      const snapshot = await get(ref(db, `friendRequests/${userId}/${currentUser.uid}`));
      return snapshot.exists();
    }

    // Send Friend Request
    window.sendFriendRequest = async (toUserId) => {
      try {
        await set(ref(db, `friendRequests/${toUserId}/${currentUser.uid}`), {
          from: currentUser.uid,
          timestamp: Date.now()
        });
        showToast("Arkadas istegi gonderildi");
        closeUserProfile();
      } catch (error) {
        console.error("Request error:", error);
        showToast("Bir hata olustu");
      }
    };

    // Load Friend Requests with realtime notifications
    function loadFriendRequests() {
      if (requestsListener) off(ref(db, `friendRequests/${currentUser.uid}`));
      
      const requestsRef = ref(db, `friendRequests/${currentUser.uid}`);
      
      // Listen for new requests
      onChildAdded(requestsRef, async (snapshot) => {
        const request = snapshot.val();
        
        // Show notification for new requests
        if (lastNotificationData !== request.from) {
          const senderSnapshot = await get(ref(db, `users/${request.from}`));
          if (senderSnapshot.exists()) {
            const sender = senderSnapshot.val();
            showNotification(
              sender.photoURL,
              'Arkadas Istegi',
              `${sender.displayName} size arkadas istegi gonderdi`
            );
            lastNotificationData = request.from;
          }
        }
      });
      
      // Update badge count
      onValue(requestsRef, (snapshot) => {
        const count = snapshot.exists() ? Object.keys(snapshot.val()).length : 0;
        const badge = document.getElementById('requestsBadge');
        const navBadge = document.getElementById('friendsNavBadge');
        
        if (count > 0) {
          badge.textContent = count;
          badge.style.display = 'flex';
          navBadge.classList.add('show');
        } else {
          badge.style.display = 'none';
          navBadge.classList.remove('show');
        }
      });
      
      requestsListener = requestsRef;
    }

    // Show Notification
    function showNotification(avatar, title, desc) {
      document.getElementById('notificationAvatar').src = avatar;
      document.getElementById('notificationTitle').textContent = title;
      document.getElementById('notificationDesc').textContent = desc;
      document.getElementById('notificationPopup').classList.add('show');
      
      setTimeout(() => {
        document.getElementById('notificationPopup').classList.remove('show');
      }, 5000);
    }

    window.handleNotificationClick = () => {
      document.getElementById('notificationPopup').classList.remove('show');
      navigateTo('friends');
      switchFriendsTab('requests');
    };

    // Friends Tab
    window.switchFriendsTab = (tab) => {
      document.querySelectorAll('.tabs .tab').forEach(t => t.classList.remove('active'));
      event.target.classList.add('active');
      
      if (tab === 'friends') {
        loadFriends();
      } else if (tab === 'requests') {
        loadRequests();
      } else if (tab === 'sent') {
        loadSentRequests();
      }
    };

    // Load Friends
    async function loadFriends() {
      const container = document.getElementById('friendsContent');
      container.innerHTML = '<div class="loading"><div class="spinner"></div></div>';
      
      const friendsRef = ref(db, `friends/${currentUser.uid}`);
      const snapshot = await get(friendsRef);
      
      if (!snapshot.exists()) {
        container.innerHTML = '<div class="empty-state"><i class="fas fa-user-friends"></i><p>Henuz arkadasiniz yok</p></div>';
        return;
      }
      
      let html = '<div class="user-list">';
      for (const [friendId, data] of Object.entries(snapshot.val())) {
        const friendSnapshot = await get(ref(db, `users/${friendId}`));
        if (friendSnapshot.exists()) {
          const friend = friendSnapshot.val();
          const verifiedBadge = friend.verified ? '<i class="fas fa-check-circle verified-badge"></i>' : '';
          html += `
            <div class="user-card" onclick="openUserProfile('${friendId}')">
              <div class="avatar-wrapper">
                <img class="user-card-avatar" src="${friend.photoURL}" alt="">
                ${friend.online ? '<div class="online-dot"></div>' : ''}
              </div>
              <div class="user-card-info">
                <div class="user-card-name">${friend.displayName} ${verifiedBadge}</div>
                <div class="user-card-username">@${friend.username}</div>
              </div>
              <button class="user-card-action" onclick="event.stopPropagation(); openChat('${friendId}')">Mesaj</button>
            </div>
          `;
        }
      }
      html += '</div>';
      container.innerHTML = html;
    }

    // Load Requests
    async function loadRequests() {
      const container = document.getElementById('friendsContent');
      container.innerHTML = '<div class="loading"><div class="spinner"></div></div>';
      
      const requestsRef = ref(db, `friendRequests/${currentUser.uid}`);
      const snapshot = await get(requestsRef);
      
      if (!snapshot.exists()) {
        container.innerHTML = '<div class="empty-state"><i class="fas fa-inbox"></i><p>Bekleyen istek yok</p></div>';
        return;
      }
      
      let html = '<div class="user-list">';
      for (const [fromId, data] of Object.entries(snapshot.val())) {
        const userSnapshot = await get(ref(db, `users/${fromId}`));
        if (userSnapshot.exists()) {
          const user = userSnapshot.val();
          const verifiedBadge = user.verified ? '<i class="fas fa-check-circle verified-badge"></i>' : '';
          html += `
            <div class="request-card">
              <div class="avatar-wrapper">
                <img class="user-card-avatar" src="${user.photoURL}" alt="">
              </div>
              <div class="user-card-info">
                <div class="user-card-name">${user.displayName} ${verifiedBadge}</div>
                <div class="user-card-username">@${user.username}</div>
              </div>
              <div class="request-actions">
                <button class="btn-accept" onclick="acceptRequest('${fromId}')"><i class="fas fa-check"></i></button>
                <button class="btn-reject" onclick="rejectRequest('${fromId}')"><i class="fas fa-times"></i></button>
              </div>
            </div>
          `;
        }
      }
      html += '</div>';
      container.innerHTML = html;
    }

    // Load Sent Requests
    async function loadSentRequests() {
      const container = document.getElementById('friendsContent');
      container.innerHTML = '<div class="loading"><div class="spinner"></div></div>';
      
      const usersSnapshot = await get(ref(db, 'users'));
      if (!usersSnapshot.exists()) {
        container.innerHTML = '<div class="empty-state"><i class="fas fa-paper-plane"></i><p>Gonderilen istek yok</p></div>';
        return;
      }
      
      let html = '<div class="user-list">';
      let hasRequests = false;
      
      for (const [userId, user] of Object.entries(usersSnapshot.val())) {
        if (userId === currentUser.uid) continue;
        
        const requestSnapshot = await get(ref(db, `friendRequests/${userId}/${currentUser.uid}`));
        if (requestSnapshot.exists()) {
          hasRequests = true;
          const verifiedBadge = user.verified ? '<i class="fas fa-check-circle verified-badge"></i>' : '';
          html += `
            <div class="user-card">
              <div class="avatar-wrapper">
                <img class="user-card-avatar" src="${user.photoURL}" alt="">
              </div>
              <div class="user-card-info">
                <div class="user-card-name">${user.displayName} ${verifiedBadge}</div>
                <div class="user-card-username">@${user.username}</div>
              </div>
              <span class="user-card-action pending">Bekliyor</span>
            </div>
          `;
        }
      }
      html += '</div>';
      
      container.innerHTML = hasRequests ? html : '<div class="empty-state"><i class="fas fa-paper-plane"></i><p>Gonderilen istek yok</p></div>';
    }

    // Accept Request
    window.acceptRequest = async (fromId) => {
      try {
        // Add to both friends lists
        await set(ref(db, `friends/${currentUser.uid}/${fromId}`), { since: Date.now() });
        await set(ref(db, `friends/${fromId}/${currentUser.uid}`), { since: Date.now() });
        
        // Remove request
        await remove(ref(db, `friendRequests/${currentUser.uid}/${fromId}`));
        
        showToast("Arkadas eklendi");
        loadRequests();
      } catch (error) {
        console.error("Accept error:", error);
        showToast("Bir hata olustu");
      }
    };

    // Reject Request
    window.rejectRequest = async (fromId) => {
      try {
        await remove(ref(db, `friendRequests/${currentUser.uid}/${fromId}`));
        showToast("Istek reddedildi");
        loadRequests();
      } catch (error) {
        console.error("Reject error:", error);
      }
    };

    // Load Friend Count Realtime
    function loadFriendCountRealtime() {
      const friendsRef = ref(db, `friends/${currentUser.uid}`);
      onValue(friendsRef, (snapshot) => {
        const count = snapshot.exists() ? Object.keys(snapshot.val()).length : 0;
        document.getElementById('friendCount').textContent = count;
      });
    }

    // Load Chats
    function loadChats() {
      const chatsRef = ref(db, `userChats/${currentUser.uid}`);
      onValue(chatsRef, async (snapshot) => {
        const container = document.getElementById('chatList');
        
        if (!snapshot.exists()) {
          container.innerHTML = '<div class="empty-state"><i class="fas fa-comment-dots"></i><p>Henuz bir sohbetin yok</p></div>';
          return;
        }
        
        let html = '';
        const chats = [];
        
        for (const [oderId, chatData] of Object.entries(snapshot.val())) {
          const userSnapshot = await get(ref(db, `users/${chatData.oderId || oderId}`));
          if (userSnapshot.exists()) {
            chats.push({
              oderId: chatData.oderId || oderId,
              user: userSnapshot.val(),
              lastMessage: chatData.lastMessage || '',
              timestamp: chatData.timestamp || 0
            });
          }
        }
        
        // Sort by timestamp
        chats.sort((a, b) => b.timestamp - a.timestamp);
        
        chats.forEach(chat => {
          const verifiedBadge = chat.user.verified ? '<i class="fas fa-check-circle verified-badge"></i>' : '';
          html += `
            <div class="chat-item" onclick="openChat('${chat.oderId}')">
              <div class="avatar-wrapper">
                <img class="user-card-avatar" src="${chat.user.photoURL}" alt="">
                ${chat.user.online ? '<div class="online-dot"></div>' : ''}
              </div>
              <div class="chat-item-info">
                <div class="chat-item-name">${chat.user.displayName} ${verifiedBadge}</div>
                <div class="chat-item-preview">${chat.lastMessage}</div>
              </div>
              <div class="chat-item-meta">
                <div class="chat-item-time">${formatTime(chat.timestamp)}</div>
              </div>
            </div>
          `;
        });
        
        container.innerHTML = html || '<div class="empty-state"><i class="fas fa-comment-dots"></i><p>Henuz bir sohbetin yok</p></div>';
      });
    }

    // Open Chat
    window.openChat = async (userId) => {
      currentChatUserId = userId;
      
      const userSnapshot = await get(ref(db, `users/${userId}`));
      if (!userSnapshot.exists()) return;
      
      const user = userSnapshot.val();
      const verifiedBadge = user.verified ? '<i class="fas fa-check-circle verified-badge"></i>' : '';
      
      document.getElementById('chatViewAvatar').src = user.photoURL;
      document.getElementById('chatViewName').innerHTML = user.displayName + ' ' + verifiedBadge;
      document.getElementById('chatViewStatus').textContent = user.online ? 'Cevrimici' : 'Cevrimdisi';
      
      document.getElementById('chatView').classList.add('active');
      
      // Create chat entry for both users
      const chatId = [currentUser.uid, userId].sort().join('_');
      
      // Set userChats for current user
      await update(ref(db, `userChats/${currentUser.uid}/${chatId}`), {
        oderId: userId,
        timestamp: Date.now()
      });
      
      // Set userChats for oer user
      await update(ref(db, `userChats/${userId}/${chatId}`), {
        oderId: currentUser.uid,
        timestamp: Date.now()
      });
      
      loadMessages(chatId);
    };

    // Load Messages
    function loadMessages(chatId) {
      const messagesRef = ref(db, `messages/${chatId}`);
      
      if (chatListener) off(chatListener);
      
      onValue(messagesRef, (snapshot) => {
        const container = document.getElementById('chatMessages');
        
        if (!snapshot.exists()) {
          container.innerHTML = '<div class="empty-state"><i class="fas fa-comments"></i><p>Mesaj yok. Sohbete basla!</p></div>';
          return;
        }
        
        let html = '';
        snapshot.forEach((child) => {
          const msg = child.val();
          const isSent = msg.senderId === currentUser.uid;
          html += `
            <div class="message ${isSent ? 'sent' : 'received'}">
              ${msg.text}
              <div class="message-time">${formatTime(msg.timestamp)}</div>
            </div>
          `;
        });
        
        container.innerHTML = html;
        container.scrollTop = container.scrollHeight;
      });
      
      chatListener = messagesRef;
    }

    // Send Message
    window.sendMessage = async () => {
      const input = document.getElementById('messageInput');
      const text = input.value.trim();
      
      if (!text || !currentChatUserId) return;
      
      const chatId = [currentUser.uid, currentChatUserId].sort().join('_');
      
      try {
        await push(ref(db, `messages/${chatId}`), {
          senderId: currentUser.uid,
          text,
          timestamp: Date.now()
        });
        
        // Update last message for both users
        await update(ref(db, `userChats/${currentUser.uid}/${chatId}`), {
          lastMessage: text,
          timestamp: Date.now(),
          oderId: currentChatUserId
        });
        
        await update(ref(db, `userChats/${currentChatUserId}/${chatId}`), {
          lastMessage: text,
          timestamp: Date.now(),
          oderId: currentUser.uid
        });
        
        input.value = '';
      } catch (error) {
        console.error("Message error:", error);
      }
    };

    window.handleMessageKeypress = (e) => {
      if (e.key === 'Enter') sendMessage();
    };

    window.closeChatView = () => {
      document.getElementById('chatView').classList.remove('active');
      if (chatListener) off(chatListener);
      currentChatUserId = null;
    };

    // Load Games
    function loadGames() {
      const gamesRef = ref(db, 'games');
      onValue(gamesRef, (snapshot) => {
        const container = document.getElementById('gamesGrid');
        
        if (!snapshot.exists()) {
          container.innerHTML = '<div class="empty-state"><i class="fas fa-gamepad"></i><p>Henuz oyun eklenmemis</p></div>';
          return;
        }
        
        let html = '';
        snapshot.forEach((child) => {
          const game = child.val();
          const iconHtml = game.iconUrl 
            ? `<img class="game-card-icon" src="${game.iconUrl}" alt="${game.name}">`
            : `<i class="${game.icon || 'fas fa-gamepad'}"></i>`;
          
          html += `
            <div class="game-card" onclick="${game.url ? `window.open('${game.url}', '_blank')` : ''}">
              ${iconHtml}
              <h4>${game.name}</h4>
              <p>${game.description || ''}</p>
            </div>
          `;
        });
        
        container.innerHTML = html;
      });
    }

    // Load Events
    function loadEvents() {
      const eventsRef = ref(db, 'events');
      onValue(eventsRef, (snapshot) => {
        const container = document.getElementById('eventsList');
        
        if (!snapshot.exists()) {
          container.innerHTML = '<div class="empty-state"><i class="fas fa-calendar-alt"></i><p>Henuz etkinlik eklenmemis</p></div>';
          return;
        }
        
        let html = '';
        snapshot.forEach((child) => {
          const event = child.val();
          const eventId = child.key;
          const participantCount = event.participants ? Object.keys(event.participants).length : 0;
          
          html += `
            <div class="event-card" onclick="openEventDetail('${eventId}')">
              ${event.imageUrl ? `<img class="event-card-image" src="${event.imageUrl}" alt="">` : ''}
              <div class="event-card-content">
                <span class="event-date"><i class="fas fa-calendar"></i> ${formatEventDate(event.date)}</span>
                <h4>${event.title}</h4>
                <p>${event.description ? event.description.substring(0, 100) + '...' : ''}</p>
                <div class="event-card-footer">
                  <span class="event-participants"><i class="fas fa-users"></i> ${participantCount} katilimci</span>
                </div>
              </div>
            </div>
          `;
        });
        
        container.innerHTML = html;
      });
    }

    // Open Event Detail
    window.openEventDetail = async (eventId) => {
      currentEventId = eventId;
      
      const snapshot = await get(ref(db, `events/${eventId}`));
      if (!snapshot.exists()) return;
      
      const event = snapshot.val();
      
      document.getElementById('eventModalImage').src = event.imageUrl || 'https://via.placeholder.com/500x200/d4a574/3d2f1f?text=Etkinlik';
      document.getElementById('eventModalTitle').textContent = event.title;
      document.getElementById('eventModalDate').textContent = formatEventDate(event.date);
      document.getElementById('eventModalDesc').textContent = event.description || '';
      
      const participantCount = event.participants ? Object.keys(event.participants).length : 0;
      document.getElementById('eventModalParticipants').textContent = `${participantCount} kisi katiliyor`;
      
      // Check if user joined
      const isJoined = event.participants && event.participants[currentUser.uid];
      const joinBtn = document.getElementById('eventJoinBtn');
      
      if (isJoined) {
        joinBtn.innerHTML = '<i class="fas fa-check"></i> Katiliyorsunuz';
        joinBtn.classList.add('joined');
      } else {
        joinBtn.innerHTML = '<i class="fas fa-hand-paper"></i> Katilmak Istiyorum';
        joinBtn.classList.remove('joined');
      }
      
      // Load Q&A
      loadEventQA(eventId);
      
      document.getElementById('eventModal').classList.add('active');
    };

    window.closeEventModal = () => {
      document.getElementById('eventModal').classList.remove('active');
      currentEventId = null;
    };

    // Toggle Event Join
    window.toggleEventJoin = async () => {
      if (!currentEventId) return;
      
      const participantRef = ref(db, `events/${currentEventId}/participants/${currentUser.uid}`);
      const snapshot = await get(participantRef);
      
      if (snapshot.exists()) {
        await remove(participantRef);
        showToast("Katilim iptal edildi");
      } else {
        await set(participantRef, {
          joinedAt: Date.now(),
          displayName: currentUserData.displayName
        });
        showToast("Etkinlige katildiniz");
      }
      
      openEventDetail(currentEventId);
    };

    // Load Event Q&A
    async function loadEventQA(eventId) {
      const container = document.getElementById('eventQAList');
      const qaRef = ref(db, `eventQA/${eventId}`);
      const snapshot = await get(qaRef);
      
      if (!snapshot.exists()) {
        container.innerHTML = '<p style="opacity:0.7;text-align:center;">Henuz soru sorulmamis</p>';
        return;
      }
      
      let html = '';
      snapshot.forEach((child) => {
        const qa = child.val();
        html += `
          <div class="qa-item">
            <div class="qa-question">
              <i class="fas fa-question-circle"></i>
              <span>${qa.question}</span>
            </div>
            ${qa.answer ? `
              <div class="qa-answer">
                <div class="qa-answerer">
                  <i class="fas fa-check-circle"></i> ${qa.answeredBy || 'Yetkili'}
                </div>
                ${qa.answer}
              </div>
            ` : '<div class="qa-answer" style="opacity:0.5;">Henuz cevaplanmadi</div>'}
          </div>
        `;
      });
      
      container.innerHTML = html;
    }

    // Submit Question
    window.submitQuestion = async () => {
      if (!currentEventId) return;
      
      const input = document.getElementById('questionInput');
      const question = input.value.trim();
      
      if (!question) {
        showToast("Lutfen bir soru yazin");
        return;
      }
      
      try {
        await push(ref(db, `eventQA/${currentEventId}`), {
          question,
          askedBy: currentUser.uid,
          askedByName: currentUserData.displayName,
          timestamp: Date.now(),
          answer: null,
          answeredBy: null
        });
        
        input.value = '';
        showToast("Sorunuz gonderildi");
        loadEventQA(currentEventId);
      } catch (error) {
        console.error("Question error:", error);
        showToast("Bir hata olustu");
      }
    };

    // Load My Events
    async function loadMyEvents() {
      const container = document.getElementById('myEventsList');
      container.innerHTML = '<div class="loading"><div class="spinner"></div></div>';
      
      const eventsSnapshot = await get(ref(db, 'events'));
      if (!eventsSnapshot.exists()) {
        container.innerHTML = '<div class="empty-state"><i class="fas fa-calendar-check"></i><p>Henuz bir etkinlige katilmadiniz</p></div>';
        return;
      }
      
      let html = '';
      eventsSnapshot.forEach((child) => {
        const event = child.val();
        const eventId = child.key;
        
        if (event.participants && event.participants[currentUser.uid]) {
          html += `
            <div class="my-event-item" onclick="openEventDetail('${eventId}')">
              <img src="${event.imageUrl || 'https://via.placeholder.com/60/d4a574/3d2f1f?text=E'}" alt="">
              <div class="my-event-info">
                <h4>${event.title}</h4>
                <p><i class="fas fa-calendar"></i> ${formatEventDate(event.date)}</p>
              </div>
              <i class="fas fa-chevron-right" style="opacity:0.5;"></i>
            </div>
          `;
        }
      });
      
      container.innerHTML = html || '<div class="empty-state"><i class="fas fa-calendar-check"></i><p>Henuz bir etkinlige katilmadiniz</p></div>';
    }

    // Settings
    window.openSettings = () => {
      // Load current settings
      document.getElementById('darkThemeToggle').checked = document.body.classList.contains('dark-theme');
      document.getElementById('instagramUsername').value = currentUserData.instagram || '';
      document.getElementById('tiktokUsername').value = currentUserData.tiktok || '';
      document.getElementById('twitterUsername').value = currentUserData.twitter || '';
      
      document.getElementById('settingsModal').classList.add('active');
    };

    window.closeSettings = () => {
      document.getElementById('settingsModal').classList.remove('active');
    };

    window.toggleTheme = () => {
      const toggle = document.getElementById('darkThemeToggle');
      toggle.checked = !toggle.checked;
    };

    window.saveSettings = async () => {
      const darkTheme = document.getElementById('darkThemeToggle').checked;
      const instagram = document.getElementById('instagramUsername').value.trim();
      const tiktok = document.getElementById('tiktokUsername').value.trim();
      const twitter = document.getElementById('twitterUsername').value.trim();
      
      try {
        await update(ref(db, `users/${currentUser.uid}`), {
          darkTheme,
          instagram,
          tiktok,
          twitter
        });
        
        currentUserData.darkTheme = darkTheme;
        currentUserData.instagram = instagram;
        currentUserData.tiktok = tiktok;
        currentUserData.twitter = twitter;
        
        if (darkTheme) {
          document.body.classList.add('dark-theme');
        } else {
          document.body.classList.remove('dark-theme');
        }
        
        localStorage.setItem('darkTheme', darkTheme);
        
        updateSocialLinks();
        showToast("Ayarlar kaydedildi");
        closeSettings();
      } catch (error) {
        console.error("Settings error:", error);
        showToast("Bir hata olustu");
      }
    };

    function loadTheme() {
      if (currentUserData.darkTheme) {
        document.body.classList.add('dark-theme');
      }
    }

    // Utility Functions
    function formatDate(timestamp) {
      if (!timestamp) return '-';
      return new Date(timestamp).toLocaleDateString('tr-TR');
    }

    function formatTime(timestamp) {
      if (!timestamp) return '';
      const date = new Date(timestamp);
      return date.toLocaleTimeString('tr-TR', { hour: '2-digit', minute: '2-digit' });
    }

    function formatEventDate(dateStr) {
      if (!dateStr) return '-';
      const date = new Date(dateStr);
      return date.toLocaleDateString('tr-TR', { day: 'numeric', month: 'long', year: 'numeric' });
    }

    function showToast(message) {
      const toast = document.getElementById('toast');
      toast.textContent = message;
      toast.classList.add('show');
      setTimeout(() => toast.classList.remove('show'), 3000);
    }

    // Handle page visibility
    document.addEventListener('visibilitychange', () => {
      if (currentUser) {
        updateUserOnlineStatus(!document.hidden);
      }
    });

    window.addEventListener('beforeunload', () => {
      if (currentUser) {
        updateUserOnlineStatus(false);
      }
    });
  </script>
</body>
</html>
